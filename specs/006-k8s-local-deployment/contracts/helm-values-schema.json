{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "AI Wealth Companion Helm Values",
  "description": "Schema for values.yaml configuration",
  "type": "object",
  "required": ["global", "backend", "frontend"],
  "properties": {
    "global": {
      "type": "object",
      "description": "Global configuration shared across all services",
      "properties": {
        "namespace": {
          "type": "string",
          "default": "ai-wealth",
          "description": "Kubernetes namespace for deployment"
        },
        "imagePullPolicy": {
          "type": "string",
          "enum": ["Always", "IfNotPresent", "Never"],
          "default": "IfNotPresent"
        },
        "environment": {
          "type": "string",
          "enum": ["development", "staging", "production"],
          "default": "development"
        }
      },
      "required": ["namespace"]
    },
    "backend": {
      "type": "object",
      "description": "Backend FastAPI service configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true
        },
        "replicaCount": {
          "type": "integer",
          "minimum": 1,
          "default": 1
        },
        "image": {
          "type": "object",
          "properties": {
            "repository": {
              "type": "string",
              "default": "ai-wealth-companion/backend"
            },
            "tag": {
              "type": "string",
              "default": "dev"
            }
          }
        },
        "service": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": ["ClusterIP", "NodePort", "LoadBalancer"],
              "default": "ClusterIP"
            },
            "port": {
              "type": "integer",
              "default": 8000
            }
          }
        },
        "resources": {
          "type": "object",
          "properties": {
            "requests": {
              "type": "object",
              "properties": {
                "cpu": { "type": "string", "default": "100m" },
                "memory": { "type": "string", "default": "256Mi" }
              }
            },
            "limits": {
              "type": "object",
              "properties": {
                "cpu": { "type": "string", "default": "500m" },
                "memory": { "type": "string", "default": "512Mi" }
              }
            }
          }
        },
        "healthCheck": {
          "type": "object",
          "properties": {
            "livenessPath": { "type": "string", "default": "/health" },
            "readinessPath": { "type": "string", "default": "/health/ready" }
          }
        }
      },
      "required": ["enabled", "image"]
    },
    "frontend": {
      "type": "object",
      "description": "Frontend Next.js service configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true
        },
        "replicaCount": {
          "type": "integer",
          "minimum": 1,
          "default": 1
        },
        "image": {
          "type": "object",
          "properties": {
            "repository": {
              "type": "string",
              "default": "ai-wealth-companion/frontend"
            },
            "tag": {
              "type": "string",
              "default": "dev"
            }
          }
        },
        "service": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": ["ClusterIP", "NodePort", "LoadBalancer"],
              "default": "ClusterIP"
            },
            "port": {
              "type": "integer",
              "default": 3000
            }
          }
        },
        "resources": {
          "type": "object",
          "properties": {
            "requests": {
              "type": "object",
              "properties": {
                "cpu": { "type": "string", "default": "100m" },
                "memory": { "type": "string", "default": "128Mi" }
              }
            },
            "limits": {
              "type": "object",
              "properties": {
                "cpu": { "type": "string", "default": "300m" },
                "memory": { "type": "string", "default": "256Mi" }
              }
            }
          }
        }
      },
      "required": ["enabled", "image"]
    },
    "mcpServer": {
      "type": "object",
      "description": "MCP Server configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true
        },
        "replicaCount": {
          "type": "integer",
          "minimum": 1,
          "default": 1
        },
        "image": {
          "type": "object",
          "properties": {
            "repository": {
              "type": "string",
              "default": "ai-wealth-companion/mcp-server"
            },
            "tag": {
              "type": "string",
              "default": "dev"
            }
          }
        },
        "service": {
          "type": "object",
          "properties": {
            "port": {
              "type": "integer",
              "default": 8080
            }
          }
        }
      }
    },
    "ingress": {
      "type": "object",
      "description": "Ingress configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true
        },
        "className": {
          "type": "string",
          "default": "nginx"
        },
        "host": {
          "type": "string",
          "default": "ai-wealth.local"
        },
        "tls": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": false },
            "secretName": { "type": "string" }
          }
        }
      }
    },
    "secrets": {
      "type": "object",
      "description": "External secrets configuration (values provided at deploy time)",
      "properties": {
        "database": {
          "type": "object",
          "properties": {
            "existingSecret": { "type": "string" },
            "urlKey": { "type": "string", "default": "DATABASE_URL" }
          }
        },
        "jwt": {
          "type": "object",
          "properties": {
            "existingSecret": { "type": "string" },
            "secretKey": { "type": "string", "default": "JWT_SECRET_KEY" }
          }
        },
        "ai": {
          "type": "object",
          "properties": {
            "existingSecret": { "type": "string" },
            "geminiKey": { "type": "string", "default": "GEMINI_API_KEY" }
          }
        }
      }
    },
    "autoscaling": {
      "type": "object",
      "description": "HPA configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": false
        },
        "minReplicas": {
          "type": "integer",
          "default": 1
        },
        "maxReplicas": {
          "type": "integer",
          "default": 3
        },
        "targetCPUUtilization": {
          "type": "integer",
          "default": 70
        }
      }
    }
  }
}
